# Data Models (Các Mô hình Dữ liệu)

## Core Business Entities (Các Thực thể Kinh doanh Cốt lõi)

**ABP Code-First Approach (Phương pháp ABP Code-First):** The system uses ABP Framework's code-first approach where domain entities are defined in the backend, and TypeScript interfaces are automatically generated for the frontend using ABP CLI proxy generation (Hệ thống sử dụng phương pháp code-first của ABP Framework, trong đó các domain entity được định nghĩa ở backend, và các TypeScript interface được tự động tạo cho frontend bằng ABP CLI proxy generation).

Based on the PRD requirements, the key business entities for Vietnamese restaurant operations (Dựa trên yêu cầu PRD, các thực thể kinh doanh chính cho hoạt động nhà hàng Việt Nam):

### Order (Đơn hàng)

**Purpose:** Central entity for customer orders with real-time status tracking (Mục đích: Thực thể trung tâm cho đơn hàng khách hàng với theo dõi trạng thái thời gian thực)

**Backend Entity (Entity Backend):**
```csharp
// aspnet-core/src/SmartRestaurant.Domain/Entities/Orders/Order.cs
public class Order : FullAuditedAggregateRoot<Guid>
{
    /// <summary>Số đơn hàng hiển thị cho khách hàng (ví dụ: #001, #002)</summary>
    public string OrderNumber { get; set; }
    
    /// <summary>ID của bàn mà đơn hàng này được đặt</summary>
    public Guid TableId { get; set; }
    
    /// <summary>Loại đơn hàng: Ăn tại chỗ hoặc Mang về</summary>
    public OrderType OrderType { get; set; }
    
    /// <summary>Trạng thái hiện tại của đơn hàng</summary>
    public OrderStatus Status { get; set; }
    
    /// <summary>Tổng tiền của đơn hàng (VND)</summary>
    public decimal TotalAmount { get; set; }
    
    /// <summary>Ghi chú đặc biệt từ khách hàng (ví dụ: "Không cay", "Ít đường")</summary>
    public string Notes { get; set; }
    
    // Navigation properties (Thuộc tính điều hướng)
    /// <summary>Bàn ăn liên kết với đơn hàng này</summary>
    public virtual Table Table { get; set; }
    
    /// <summary>Danh sách các món ăn trong đơn hàng</summary>
    public virtual ICollection<OrderItem> OrderItems { get; set; }
}

/// <summary>Loại đơn hàng</summary>
public enum OrderType
{
    /// <summary>Ăn tại chỗ</summary>
    DineIn,
    
    /// <summary>Mang về</summary>
    Takeaway
}

/// <summary>Trạng thái đơn hàng</summary>
public enum OrderStatus
{
    /// <summary>Chờ xác nhận</summary>
    Pending,
    
    /// <summary>Đã xác nhận</summary>
    Confirmed,
    
    /// <summary>Đang chế biến</summary>
    Preparing,
    
    /// <summary>Sẵn sàng phục vụ</summary>
    Ready,
    
    /// <summary>Đã phục vụ</summary>
    Served,
    
    /// <summary>Đã thanh toán</summary>
    Paid
}
```

**Auto-Generated Frontend Interface (Interface Frontend tự động tạo):**
```typescript
// Generated by ABP CLI: abp generate-proxy -t ng
// Location: src/app/proxy/orders/models.ts
export interface OrderDto {
  /** ID đơn hàng */
  id: string;
  
  /** Số đơn hàng hiển thị cho khách hàng */
  orderNumber: string;
  
  /** ID của bàn */
  tableId: string;
  
  /** Loại đơn hàng */
  orderType: OrderType;
  
  /** Trạng thái đơn hàng */
  status: OrderStatus;
  
  /** Tổng tiền (VND) */
  totalAmount: number;
  
  /** Ghi chú từ khách hàng */
  notes?: string;
  
  /** Thời gian tạo đơn hàng */
  creationTime: string;
  
  /** ID nhân viên tạo đơn */
  creatorId?: string;
}

/** Loại đơn hàng */
export enum OrderType {
  /** Ăn tại chỗ */
  DineIn = 0,
  
  /** Mang về */
  Takeaway = 1
}

/** Trạng thái đơn hàng */
export enum OrderStatus {
  /** Chờ xác nhận */
  Pending = 0,
  
  /** Đã xác nhận */
  Confirmed = 1,
  
  /** Đang chế biến */
  Preparing = 2,
  
  /** Sẵn sàng phục vụ */
  Ready = 3,
  
  /** Đã phục vụ */
  Served = 4,
  
  /** Đã thanh toán */
  Paid = 5
}
```

**Relationships:**
- One-to-Many with OrderItem
- Many-to-One with Table
- Many-to-One with Customer (optional)

### MenuItem (Món ăn)

**Purpose:** Two-level menu management with category and item-level control (Mục đích: Quản lý menu hai cấp với kiểm soát cấp danh mục và cấp món)

**Backend Entity (Entity Backend):**
```csharp
// aspnet-core/src/SmartRestaurant.Domain/Entities/Menu/MenuItem.cs
public class MenuItem : FullAuditedEntity<Guid>
{
    /// <summary>ID danh mục menu (ví dụ: Khai vị, Món chính, Đồ uống)</summary>
    public Guid CategoryId { get; set; }
    
    /// <summary>Tên món ăn (ví dụ: "Phở Bò", "Cơm Tấm", "Chả Cá Lá Vọng")</summary>
    public string Name { get; set; }
    
    /// <summary>Mô tả chi tiết về món ăn</summary>
    public string Description { get; set; }
    
    /// <summary>Giá món ăn (VND)</summary>
    public decimal Price { get; set; }
    
    /// <summary>Món có sẵn để đặt hay không</summary>
    public bool IsAvailable { get; set; }
    
    /// <summary>Thời gian chế biến (phút)</summary>
    public int PreparationTime { get; set; }
    
    /// <summary>Khu vực bếp chế biến món này</summary>
    public KitchenStation KitchenStation { get; set; }
    
    /// <summary>URL hình ảnh món ăn</summary>
    public string ImageUrl { get; set; }
    
    // Navigation properties (Thuộc tính điều hướng)
    /// <summary>Danh mục menu chứa món ăn này</summary>
    public virtual MenuCategory Category { get; set; }
    
    /// <summary>Các lần món này được đặt trong đơn hàng</summary>
    public virtual ICollection<OrderItem> OrderItems { get; set; }
}

/// <summary>Khu vực bếp chế biến</summary>
public enum KitchenStation
{
    /// <summary>Khu vực chung</summary>
    General,
    
    /// <summary>Khu vực nấu lẩu</summary>
    Hotpot,
    
    /// <summary>Khu vực nướng</summary>
    Grilled,
    
    /// <summary>Khu vực pha chế đồ uống</summary>
    Drinking
}
```

**Auto-Generated Frontend Interface (Interface Frontend tự động tạo):**
```typescript
// Generated by ABP CLI: src/app/proxy/menu/models.ts
export interface MenuItemDto {
  /** ID món ăn */
  id: string;
  
  /** ID danh mục menu */
  categoryId: string;
  
  /** Tên món ăn */
  name: string;
  
  /** Mô tả món ăn */
  description: string;
  
  /** Giá món ăn (VND) */
  price: number;
  
  /** Món có sẵn hay không */
  isAvailable: boolean;
  
  /** Thời gian chế biến (phút) */
  preparationTime: number;
  
  /** Khu vực bếp chế biến */
  kitchenStation: KitchenStation;
  
  /** URL hình ảnh món ăn */
  imageUrl?: string;
}

/** Khu vực bếp chế biến */
export enum KitchenStation {
  /** Khu vực chung */
  General = 0,
  
  /** Khu vực nấu lẩu */
  Hotpot = 1,
  
  /** Khu vực nướng */
  Grilled = 2,
  
  /** Khu vực pha chế đồ uống */
  Drinking = 3
}
```

**Relationships:**
- Many-to-One with MenuCategory
- One-to-Many with OrderItem
- Many-to-Many with Ingredient

### Table (Bàn ăn)

**Purpose:** Restaurant table management with real-time status (Mục đích: Quản lý bàn nhà hàng với trạng thái thời gian thực)

**Backend Entity (Entity Backend):**
```csharp
// aspnet-core/src/SmartRestaurant.Domain/Entities/Tables/Table.cs
public class Table : FullAuditedEntity<Guid>
{
    /// <summary>Số bàn hiển thị (ví dụ: "B01", "B02", "VIP1")</summary>
    public string TableNumber { get; set; }
    
    /// <summary>Số ghế/người tối đa của bàn</summary>
    public int Capacity { get; set; }
    
    /// <summary>Trạng thái hiện tại của bàn</summary>
    public TableStatus Status { get; set; }
    
    /// <summary>Vị trí bàn (ví dụ: "Tầng 1", "Khu VIP", "Sân vườn")</summary>
    public string Location { get; set; }
    
    /// <summary>ID đơn hàng hiện tại đang sử dụng bàn (nếu có)</summary>
    public Guid? CurrentOrderId { get; set; }
    
    // Navigation properties (Thuộc tính điều hướng)
    /// <summary>Tất cả đơn hàng đã sử dụng bàn này</summary>
    public virtual ICollection<Order> Orders { get; set; }
    
    /// <summary>Các lần đặt bàn cho bàn này</summary>
    public virtual ICollection<Reservation> Reservations { get; set; }
}

/// <summary>Trạng thái bàn ăn</summary>
public enum TableStatus
{
    /// <summary>Bàn trống, sẵn sàng phục vụ</summary>
    Available,
    
    /// <summary>Bàn đang có khách</summary>
    Occupied,
    
    /// <summary>Bàn đã được đặt trước</summary>
    Reserved,
    
    /// <summary>Bàn đang được dọn dẹp</summary>
    Cleaning
}
```

**Auto-Generated Frontend Interface (Interface Frontend tự động tạo):**
```typescript
// Generated by ABP CLI: src/app/proxy/tables/models.ts
export interface TableDto {
  /** ID bàn ăn */
  id: string;
  
  /** Số bàn hiển thị */
  tableNumber: string;
  
  /** Số ghế tối đa */
  capacity: number;
  
  /** Trạng thái bàn */
  status: TableStatus;
  
  /** Vị trí bàn */
  location?: string;
  
  /** ID đơn hàng hiện tại */
  currentOrderId?: string;
}

/** Trạng thái bàn ăn */
export enum TableStatus {
  /** Bàn trống, sẵn sàng */
  Available = 0,
  
  /** Bàn đang có khách */
  Occupied = 1,
  
  /** Bàn đã đặt trước */
  Reserved = 2,
  
  /** Bàn đang dọn dẹp */
  Cleaning = 3
}
```

**Relationships:**
- One-to-Many with Order
- One-to-One with Reservation (optional)

### Payment (Thanh toán)

**Purpose:** Vietnamese payment processing with staff confirmation (Mục đích: Xử lý thanh toán Việt Nam với xác nhận nhân viên)

**Backend Entity (Entity Backend):**
```csharp
// aspnet-core/src/SmartRestaurant.Domain/Entities/Payments/Payment.cs
public class Payment : FullAuditedEntity<Guid>
{
    /// <summary>ID đơn hàng cần thanh toán</summary>
    public Guid OrderId { get; set; }
    
    /// <summary>Phương thức thanh toán</summary>
    public PaymentMethod PaymentMethod { get; set; }
    
    /// <summary>Số tiền thanh toán (VND)</summary>
    public decimal Amount { get; set; }
    
    /// <summary>Trạng thái thanh toán</summary>
    public PaymentStatus Status { get; set; }
    
    /// <summary>Dữ liệu mã QR cho chuyển khoản ngân hàng</summary>
    public string QRCodeData { get; set; }
    
    /// <summary>Số hóa đơn/biên lai</summary>
    public string ReceiptNumber { get; set; }
    
    /// <summary>ID nhân viên xác nhận thanh toán</summary>
    public Guid? ConfirmedBy { get; set; }
    
    /// <summary>Thời gian xác nhận thanh toán</summary>
    public DateTime? ConfirmedAt { get; set; }
    
    // Navigation properties (Thuộc tính điều hướng)
    /// <summary>Đơn hàng liên kết với thanh toán này</summary>
    public virtual Order Order { get; set; }
}

/// <summary>Phương thức thanh toán</summary>
public enum PaymentMethod
{
    /// <summary>Tiền mặt</summary>
    Cash,
    
    /// <summary>Chuyển khoản ngân hàng</summary>
    BankTransfer
}

/// <summary>Trạng thái thanh toán</summary>
public enum PaymentStatus
{
    /// <summary>Chờ thanh toán</summary>
    Pending,
    
    /// <summary>Đã xác nhận thanh toán</summary>
    Confirmed,
    
    /// <summary>Thanh toán thất bại</summary>
    Failed
}
```

**Auto-Generated Frontend Interface (Interface Frontend tự động tạo):**
```typescript
// Generated by ABP CLI: src/app/proxy/payments/models.ts
export interface PaymentDto {
  /** ID thanh toán */
  id: string;
  
  /** ID đơn hàng */
  orderId: string;
  
  /** Phương thức thanh toán */
  paymentMethod: PaymentMethod;
  
  /** Số tiền thanh toán (VND) */
  amount: number;
  
  /** Trạng thái thanh toán */
  status: PaymentStatus;
  
  /** Dữ liệu mã QR */
  qrCodeData?: string;
  
  /** Số hóa đơn */
  receiptNumber?: string;
  
  /** ID nhân viên xác nhận */
  confirmedBy?: string;
  
  /** Thời gian xác nhận */
  confirmedAt?: string;
}

/** Phương thức thanh toán */
export enum PaymentMethod {
  /** Tiền mặt */
  Cash = 0,
  
  /** Chuyển khoản ngân hàng */
  BankTransfer = 1
}

/** Trạng thái thanh toán */
export enum PaymentStatus {
  /** Chờ thanh toán */
  Pending = 0,
  
  /** Đã xác nhận */
  Confirmed = 1,
  
  /** Thất bại */
  Failed = 2
}
```

**Relationships:**
- Many-to-One with Order
- Many-to-One with User (staff confirmation)
